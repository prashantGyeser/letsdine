letsdineApp.factory("Session",function(r,t,e){function n(t){t=t||"/",r.path(t)}var u={login:function(e,n){return t.post("/login",{user:{email:e,password:n}}).then(function(t){u.currentUser=t.data.user,u.isAuthenticated()&&r.path("/record")})},logout:function(r){t.post("/logout").then(function(){u.currentUser=null,n(r)})},register:function(e,n,s){return t.post("/users.json",{user:{email:e,password:n,password_confirmation:s}}).then(function(t){u.currentUser=t.data,u.isAuthenticated()&&r.path("/record")})},requestCurrentUser:function(){return u.isAuthenticated()?e.when(u.currentUser):t.get("/current_user").then(function(r){return u.currentUser=r.data.user,u.currentUser})},currentUser:null,isAuthenticated:function(){return!!u.currentUser}};return u});