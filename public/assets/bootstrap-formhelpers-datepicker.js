/* ==========================================================
 * bootstrap-formhelpers-datepicker.js
 * https://github.com/vlamanna/BootstrapFormHelpers
 * ==========================================================
 * Copyright 2012 Vincent Lamanna
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * ========================================================== */
!function(t){"use strict";function a(){e(t(r)).removeClass("open")}function e(a){var e,r=a.attr("data-target");return r||(r=a.attr("href"),r=r&&/#/.test(r)&&r.replace(/.*(?=#[^\s]*$)/,"")),e=t(r),e.length||(e=a.parent()),e}var r="[data-toggle=bfh-datepicker]",n=function(a,e){this.options=t.extend({},t.fn.bfhdatepicker.defaults,e),this.$element=t(a),this.initCalendar()};n.prototype={constructor:n,daysInMonth:function(t,a){return new Date(a,t,0).getDate()},dayOfWeek:function(t,a,e){return new Date(a,t,e).getDay()},formatDate:function(t,a,e){var r=this.options.format;return t+=1,t=new String(t),e=new String(e),1==t.length&&(t="0"+t),1==e.length&&(e="0"+e),r=r.replace("m",t),r=r.replace("y",a),r=r.replace("d",e)},parse:function(t,a){var e=this.options.format,r=e.indexOf("m"),n=e.indexOf("y"),d=e.indexOf("d"),i=[{type:"m",pos:r},{type:"y",pos:n},{type:"d",pos:d}];i.sort(function(t,a){return t.pos-a.pos});for(var o=a.match(/(\d+)/g),h=0;i.length>h;h++)if(i[h].type==t)return new Number(o[h]).toString()},initCalendar:function(){var t=this.options.date;if(""==t){var a=new Date;this.$element.data("month",a.getMonth()),this.$element.data("year",a.getFullYear())}else this.$element.find("input[type=text]").val(t),this.$element.data("month",this.parse("m",t)-1),this.$element.data("year",this.parse("y",t));this.updateCalendar()},updateCalendar:function(){var t,a,e,r,n,d,a=new Date;e=this.$element.data("month"),r=this.$element.data("year"),t=this.$element.find(".bfh-datepicker-calendar"),t.find("table > thead > tr > th.month > span").text(BFHMonthsList[e]),t.find("table > thead > tr > th.year > span").text(r),n=t.find("table > thead > tr.days-header"),n.html("");for(var i=0;BFHDaysList.length>i;i++)n.append("<th>"+BFHDaysList[i]+"</th>");d=t.find("table > tbody"),d.html(""),this.daysInMonth(e,r);for(var o=this.daysInMonth(e+1,r),h=this.dayOfWeek(e,r,1),c=this.dayOfWeek(e,r,o),p="",i=0;h>i;i++)0==i&&(p+="<tr>"),p+='<td class="off">'+(o-h+i)+"</td>",6==i&&(p+="</tr>",d.append(p),p="");for(var i=1;o>=i;i++){var s=this.dayOfWeek(e,r,i);0==s&&(p+="<tr>"),p+=i==a.getDate()&&e==a.getMonth()&&r==a.getFullYear()?'<td data-day="'+i+'" class="today">'+i+"</td>":'<td data-day="'+i+'">'+i+"</td>",6==s&&(p+="</tr>",d.append(p),p="")}for(var i=c+1,f=1;6>=i;i++,f++)0==i&&(p+="<tr>"),p+='<td class="off">'+f+"</td>",6==i&&(p+="</tr>",d.append(p),p="")},previousMonth:function(){var a,e,r=t(this);return a=r.closest(".bfh-datepicker"),0==a.data("month")?(a.data("month",11),a.data("year",new Number(a.data("year"))-1)):a.data("month",new Number(a.data("month"))-1),e=a.data("bfhdatepicker"),e.updateCalendar(),!1},nextMonth:function(){var a,e,r=t(this);return a=r.closest(".bfh-datepicker"),11==a.data("month")?(a.data("month",0),a.data("year",new Number(a.data("year"))+1)):a.data("month",new Number(a.data("month"))+1),e=a.data("bfhdatepicker"),e.updateCalendar(),!1},previousYear:function(){var a,e,r=t(this);return a=r.closest(".bfh-datepicker"),a.data("year",new Number(a.data("year"))-1),e=a.data("bfhdatepicker"),e.updateCalendar(),!1},nextYear:function(){var a,e,r=t(this);return a=r.closest(".bfh-datepicker"),a.data("year",new Number(a.data("year"))+1),e=a.data("bfhdatepicker"),e.updateCalendar(),!1},select:function(){var a,e,r=t(this);a=r.closest(".bfh-datepicker");var n=a.data("month"),d=a.data("year"),i=r.data("day");return e=a.data("bfhdatepicker"),a.find("input[type=text]").val(e.formatDate(n,d,i)).trigger("change"),!1},toggle:function(){var r,n,d=t(this);if(!d.is(".disabled, :disabled"))return r=e(d),n=r.hasClass("open"),a(),n||r.toggleClass("open"),!1}},t.fn.bfhdatepicker=function(a){return this.each(function(){var e=t(this),r=e.data("bfhdatepicker"),d="object"==typeof a&&a;r||e.data("bfhdatepicker",r=new n(this,d)),"string"==typeof a&&r[a]()})},t.fn.bfhdatepicker.Constructor=n,t.fn.bfhdatepicker.defaults={format:"m/d/y",date:""},t(window).on("load",function(){t("div.bfh-datepicker").each(function(){var a=t(this);a.bfhdatepicker(a.data())})}),t(function(){t("html").on("click.bfhdatepicker.data-api",a),t("body").on("click.bfhdatepicker.data-api touchstart.bfhdatepicker.data-api",r,n.prototype.toggle).on("click.bfhdatepicker.data-api touchstart.bfhdatepicker.data-api",".bfh-datepicker-calendar > table.calendar .month > .previous",n.prototype.previousMonth).on("click.bfhdatepicker.data-api touchstart.bfhdatepicker.data-api",".bfh-datepicker-calendar > table.calendar .month > .next",n.prototype.nextMonth).on("click.bfhdatepicker.data-api touchstart.bfhdatepicker.data-api",".bfh-datepicker-calendar > table.calendar .year > .previous",n.prototype.previousYear).on("click.bfhdatepicker.data-api touchstart.bfhdatepicker.data-api",".bfh-datepicker-calendar > table.calendar .year > .next",n.prototype.nextYear).on("click.bfhdatepicker.data-api touchstart.bfhdatepicker.data-api",".bfh-datepicker-calendar > table.calendar td:not(.off)",n.prototype.select).on("click.bfhdatepicker.data-api touchstart.bfhdatepicker.data-api",".bfh-datepicker-calendar > table.calendar",function(){return!1})})}(window.jQuery);