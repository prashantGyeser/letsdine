<% content_for :javascript do %>
    <%= javascript_include_tag "closed-event-overlay" %>
    <% restaurant = Restaurant.find(@event.restaurant_id)%>
    
    <script src="http://maps.googleapis.com/maps/api/js?sensor=false"></script>

    <script>
      var map;
      var marker;
      var myLatlng = new google.maps.LatLng(<%= restaurant.latitude %>,<%= restaurant.longitude %>);

      function initialize() {
        var mapOptions = {
          zoom: 14,
          center: myLatlng,
          mapTypeId: google.maps.MapTypeId.ROADMAP
        };

        map = new google.maps.Map(document.getElementById('map_canvas'),
            mapOptions);

        var contentString = '<div id="content">'+
            '<div id="siteNotice">'+
            '</div>'+
            '<h2 id="firstHeading" class="firstHeading"><%= @event.restaurant.name %></h2>'+
            '<div id="bodyContent">'+
            '<p><b>Uluru</b>, also referred to as <b>Ayers Rock</b>, is a large ' +
            'sandstone rock formation in the southern part of the '+
            'Northern Territory, central Australia. It lies 335 km (208 mi) '+
            'south west of the nearest large town, Alice Springs; 450 km '+
            '(280 mi) by road. Kata Tjuta and Uluru are the two major '+
            'features of the Uluru - Kata Tjuta National Park. Uluru is '+
            'sacred to the Pitjantjatjara and Yankunytjatjara, the '+
            'Aboriginal people of the area. It has many springs, waterholes, '+
            'rock caves and ancient paintings. Uluru is listed as a World '+
            'Heritage Site.</p>'+
            '<p>Attribution: Uluru, <a href="http://en.wikipedia.org/w/index.php?title=Uluru&oldid=297882194">'+
            'http://en.wikipedia.org/w/index.php?title=Uluru</a> (last visited June 22, 2009).</p>'+
            '</div>'+
            '</div>';

        var infowindow = new google.maps.InfoWindow({
            content: contentString
        });

        marker = new google.maps.Marker({
            position: myLatlng,
            map: map,
            title: 'Hello World!'
        });

        google.maps.event.addListener(marker, 'click', function() {
          infowindow.open(map,marker);
        });
      }

      google.maps.event.addDomListener(window, 'load', initialize);


    </script>
  
<% end %>



<% content_for :title, "#{@event.event_name} | LetsDine" %>

    <div class="container">
      <div class="row">
        <% restaurant = Restaurant.find(@event.restaurant_id)%>
        <div class="col-md-8 eventPage">
  
          <% if @event.event_image.blank? %>
              <%= image_tag restaurant.photo_url(:event_page_image).to_s %>
          <% else %>
              <%= image_tag @event.event_image_url(:event_page_image).to_s %>
          <% end %>
  
          <div class="eventPageContent">
            <h2><%=@event.event_name%></h2>
            <span>
              <i class="icon-calendar"></i>
              Saturday, 21 September 2013 4:00PM
            </span>
            <div class="eventDescription">
              <% event_description_html =  RedCloth.new(@event.event_description).to_html %>      
              <%# simple_format(@event.event_description) %>      
              <%= raw event_description_html %>
            </div>
            <h3>Menu</h3>
            <%= render partial: 'menu',  :locals => {:menu_items_categorized => @menu_items_categorized} %>
          </div>
        </div>
        <div class="col-md-4">
          <div class="row">
        
            <div class="col-md-12">
             <div class="joinEvent">
               <h2>Come Join Us</h2>
               <h4><strong>Rs. <%= restaurant.price %></strong> per person</h4>
               <form role="form">
                 <div class="form-group">
                   <label for="seats">Number of people coming</label>
                   <input type="integer" class="form-control" id="seats" placeholder="Number of people attending including you">
                  </div>
                  <div class="form-group">
                    <label for="phoneNumber">Phone number</label>
                    <p>
                      We will only use your phone number to confirm your attendance for the event.
                    </p>
                    <input type="text" class="form-control" id="phoneNumber" placeholder="Your phone number">
                  </div>
                  <button type="submit" class="css3-button css3-button_pink full_width">Join Event</button>
                </form>
              </div>
      </div>
    </div>

    <div class="row">
      <div class="col-md-12">
        <div class="joinEvent">
          <h2>Event Location</h2>
  
          <div id="map_canvas" style="width: 100%; height: 300px;background: #ccc;"></div>
  
        </div>
      </div>
    </div>

    <div class="row">
      <div class="col-md-12">
        <div class="joinEvent">
          <h2>People Attending</h2>
          
          <div class="peopleAttending">
            <% @event.attendee.each do |personAttending| %>
              <% user = personAttending.user %>
              <% if user.image.blank? %>
                <i class="icon-user no_profile_pic" data-toogle="tooltip" title="<%= user.name %>"></i>
              <% else %>
                  <%= image_tag user.image.to_s, "data-toggle" => "tooltip", :title => user.name, :class => "profilePic" %>    
              <% end %>
            <% end %>  
            
          </div>
        </div>
      </div>
    </div>

  </div>



    </div>
</div>