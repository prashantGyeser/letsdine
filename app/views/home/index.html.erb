<% content_for :javascript do %>
    <%= javascript_include_tag "closed-event-overlay" %>
    <%= javascript_include_tag "cycle" %>
<% end %>

<% content_for :homepageHeader do %>
    
         <div class="row">
          <div class="col-md-8 col-md-offset-2">
            <h4 class="topBarText">
              Meet <span class="topBarTextHighlight">great people</span> over <span class="topBarTextHighlight">great food.</span>
            </h4>
          </div>
        </div>

        <div class="row">
          <div class="col-md-6 col-md-offset-3">
            <div class="topBarButtons">
              <a href="<%= user_omniauth_authorize_path(:facebook) %>" class="css3-button css3-button_blue facebookLoginButton">
                Sign up with 
                <%= image_tag("facebookLogo.png")%>
              </a>  
              <a href="<%= new_user_registration_path %>" class="css3-button css3-button_pink facebookLoginButton">
                Sign up with email
              </a>
            </div>
            
          </div>
        </div>
    

<% end %>

<div id="map_canvas" style="width: 100%; height: 300px;background: #ccc; border-bottom:4px solid #333;"></div>

<div class="container">
    <div class="row">
        <div class="col-md-12">
            <%= render 'layouts/messages' %>
        </div>
    </div>
</div>



<div class="filter">
    <div class="container">
        <div class="row">
            <div class="col-md-12">
                City Select
            </div>
        </div>
    </div>
</div>



<div class="container">
    <div class="row-fluid">
        <div class="span12">
            <%# Adding the city name to the title i.e. the page title should read city name events eg. Hyderabad events %>
            
            <% if session[:city].nil? %>
                <% session[:city] = "" %>
            <% end %>

            
            <% if session[:city].empty? %>
                <h1>Events</h1>    
            <% else %>
                <h1><%= session[:city] %> Events</h1>
            <% end %>   
            
        </div>
    </div>
</div>


<%= render partial: 'events/event_list', :collection => @events, :as => :events %>




<div id="communication" class="modal hide fade">
  <div class="modal-header">
    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
    <h3>No events in your city</h3>
  </div>
  <div class="modal-body">

    <p>There are no events in your city right now. Leave your email address and we will get back to you once we start conducting events in your city</p>
    
    <%= form_for(@new_city_notification, :remote => true) do |f| %>
        <% if  request.location.nil? %>
            
        <% else %>
            <div class="field">
                <%= f.hidden_field :city, :value => request.location.city %>
            </div>    
        <% end %>
        <div class="field">
            <%= f.label :email %>
            <%= f.text_field :email, :placeholder => "Enter your email address" %>
        </div>    

  </div>
  <div class="modal-footer">
    <%= f.submit "Keep me informed", :class => "large awesome green", :id => "keep_me_informed"  %>
  </div>
  <% end %>
</div>

<!-- Slider script -->
<script>
$(document).ready(function(){
    //$('#firstSlider').delay(1000).fadeOut();
    $('#slider').cycle();
})
</script>


<% if @no_events_in_city == true %>
    <script>
    $(document).ready(function(){
      $('#communication').modal('show');
      $('#keep_me_informed').click(function(event) {
        var valuesToSubmit = $('#new_new_city_notification').serialize();
        $.ajax({
          url: $('#new_new_city_notification').attr('action'),
          data: valuesToSubmit,
          type: "POST",
          dataType: "JSON"
        }).success(function(json){
            $('#communication').modal('hide');
        });
        return false;
      });
    });
  </script>  
<% end %>
            
